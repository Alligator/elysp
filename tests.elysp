(defmacro test (actual exp)
  '(if (= ,actual ,exp) nil (error (string "test " ',actual " failed! expected '" ,exp "' but got '" ,actual "'"))))

# functions
(test ((fn (x) x) 2) 2)
(test ((fn (x) [,x ,x]) 2) [2 2])
(test ((fn (x y) [,x ,y]) 2 3) [2 3])

# define
(define x 2)
(test x 2)

(define x 3)
(test x 3)

# defn
(defn dfn-test (x) x)
(test (dfn-test 2) 2)

# quote and unqote
(test '1 1)
(test '(1 2 3) (quote (1 2 3)))
(test '(1 ,(+ 1 1) 3) '(1 2 3))

#Â macros and macex
(defmacro double (x) '(quote (,x ,x)))
(test (double 5) '(5 5))
(test (macex (double 5)) '(quote (5 5)))

# if
(test (if 't "yup" "nope") "yup")
(test (if nil "yup" "nope") "nope")
